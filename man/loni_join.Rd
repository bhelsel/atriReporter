% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/join.R
\name{loni_join}
\alias{loni_join}
\title{Harmonize and Join ATRI and LONI Study Data}
\usage{
loni_join(atri_data, loni_data, variables)
}
\arguments{
\item{atri_data}{A data frame containing participant- or event-level data from
the ATRI source.}

\item{loni_data}{A data frame containing participant- or event-level data from
the LONI source. When discrepancies arise between ATRI and LONI values, LONI
values are retained.}

\item{variables}{A character vector of variable names to retain or align across
datasets. (Currently reserved for future flexibility; not yet directly used.)}
}
\value{
A data frame containing harmonized ATRI–LONI data with one row per
participant–event combination.
}
\description{
This function performs a full join between ATRI and LONI datasets, harmonizing
variable types, filling missing variables, adding study and event identifiers,
and resolving discrepancies using LONI as the reference standard.
}
\details{
The join is performed at the participant–event level, with additional shared
variables included to ensure consistency across data sources.

The function proceeds through the following steps:
\enumerate{
\item Identifies variables common to both datasets (excluding
\code{subject_label} and \code{age_at_visit}).
\item Coerces mismatched variable types to character to ensure join
compatibility.
\item Ensures that all non-identifier ATRI variables exist in the LONI
dataset, creating default columns when necessary.
\item Adds standardized participant and event identifiers to the LONI data.
\item Renames ATRI subject identifiers to match LONI conventions.
\item Performs a full join across participant ID, event code, and shared
variables.
\item Resolves duplicated columns (\code{.x}/\code{.y}) by prioritizing LONI
values.
\item Orders the result by participant ID and event sequence.
}

Event codes are returned as an ordered factor to preserve longitudinal ordering.
}
\examples{
\dontrun{
merged_data <- loni_join(
  atri_data = atri_df,
  loni_data = loni_df,
  variables = c("sex", "diagnosis", "education")
)
}

}
\seealso{
\code{\link[dplyr]{full_join}},
\code{\link[dplyr]{case_when}}
}
