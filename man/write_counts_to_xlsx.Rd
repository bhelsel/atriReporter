% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/count_by.R
\name{write_counts_to_xlsx}
\alias{write_counts_to_xlsx}
\title{Write Event Counts to an Excel Worksheet}
\usage{
write_counts_to_xlsx(data, file, sheetName, id, ..., column, value = 1)
}
\arguments{
\item{data}{A data frame containing event-level data.}

\item{file}{A character string specifying the path to the Excel file
(\code{.xlsx}) to create or update.}

\item{sheetName}{A character string giving the name of the worksheet to write.
If the sheet already exists, it will be removed and recreated.}

\item{id}{A tidy-evaluated column identifying subjects or units (e.g.,
\code{subject_id}). Events are counted and ordered within this identifier.}

\item{...}{Additional columns to retain in the output (unquoted). These are
typically descriptive or grouping variables to appear alongside the ID.}

\item{column}{A tidy-evaluated column used to filter rows (e.g., an indicator
variable marking qualifying events).}

\item{value}{The value in \code{column} that indicates an event should be
included. Defaults to \code{1}.}
}
\value{
Invisibly returns \code{NULL}. The primary side effect is writing data to an
Excel file.
}
\description{
This function filters a dataset for rows matching a specified value in a
target column, enumerates events within each subject (or other identifier),
reshapes the data to a wide visit-based format, and writes the result to an
Excel worksheet. If the Excel file or worksheet already exists, it is replaced.
}
\details{
The output includes one row per identifier, with event codes spread across
visit columns (e.g., \code{V1}, \code{V2}, \code{V3}), and a summary row at the
top containing counts of non-missing events per visit.

The function:
\enumerate{
\item Filters \code{data} to rows where \code{column == value}.
\item Orders qualifying events within each \code{id} and assigns visit
positions (V1, V2, ...).
\item Reshapes the data to a wide format with one row per \code{id}.
\item Prepends a summary row showing counts of events per visit column.
\item Writes the result to an Excel worksheet using \pkg{openxlsx}.
}

Identifier variables (\code{subject_label}, \code{u19_bds_id},
\code{u01_niad_adds_id}) are automatically filled down/up and preserved when
present in the input data.
}
\examples{
\dontrun{
write_counts_to_xlsx(
  data = events,
  file = "counts.xlsx",
  sheetName = "Event Counts",
  id = subject_id,
  column = event_flag,
  value = 1,
  event_date, event_type
)
}

}
\seealso{
\code{\link[openxlsx]{writeData}},
\code{\link[tidyr]{pivot_wider}}
}
